Вот шпора по Лекции 4. Сохранена структура и стиль предыдущих частей.

---

# ШПОРА: Выбросы (Outliers) и Аномалии

## 1. Базовые определения (В чем разница?)
Это частый вопрос на понимание.

| Термин | Суть | Пример |
| :--- | :--- | :--- |
| **Выброс (Outlier)** | Аномальное значение в **одном конкретном признаке** (столбце). | Рост человека 3 метра. |
| **Аномалия (Anomaly)** | Странный **объект целиком** (строка). Комбинация признаков нестандартна. | Рост 160 см, вес 50 кг, но размер ноги 48 (по отдельности норм, вместе — подозрительно). |

---

## 2. Поиск Выбросов (Одномерные методы)
*Работают с одним столбцом. Ищем экстремальные значения.*

### А. Метод IQR (Межквартильный размах)
Самый надежный метод для ненормальных распределений.
*   $Q1$ — 25% квантиль.
*   $Q3$ — 75% квантиль.
*   $IQR = Q3 - Q1$.

**Границы "нормальности":**
$$Lower = Q1 - 1.5 \times IQR$$
$$Upper = Q3 + 1.5 \times IQR$$
*Всё, что за границами — выброс.*

### Б. Z-score (Стандартизация)
Работает, если данные распределены **нормально (Гаусс)**.
$$z = \frac{x - \mu}{\sigma}$$
*   $\mu$ — среднее, $\sigma$ — стандартное отклонение.
*   **Правило:** Если $|z| > 3$ (отклонение больше 3 сигм), это выброс.

---

## 3. Поиск Аномалий (Многомерные методы)
*Методы обучения без учителя (Unsupervised). Ищем странные строки в N-мерном пространстве.*

### 1. Isolation Forest (Изолирующий лес)
*   **Принцип:** Строит деревья и делает случайные разбиения. Аномалии "отрезаются" (изолируются) быстрее, чем нормальные точки.
*   **Фишка:** Если путь до листа в дереве короткий $\to$ это аномалия.
*   **Плюс:** Не требует нормального распределения, работает с высокой размерностью.

### 2. One-class SVM
*   **Принцип:** Строит гиперплоскость ($w \cdot x + b = 0$), пытаясь охватить "нормальные" данные в плотный шар. Всё, что снаружи — аномалия.
*   **Применение:** Когда у нас куча "хороших" данных и почти нет примеров "плохих".

### 3. DBSCAN (Кластеризация)
Алгоритм плотности. Группирует точки, которые лежат близко.
*   **Параметры:**
    *   `eps` — радиус круга.
    *   `minPts` — сколько соседей нужно, чтобы считаться "ядром".
*   **Типы точек:**
    1.  *Core:* В радиусе много соседей.
    2.  *Border:* На краю кластера.
    3.  **Noise (Шум):** Не попали ни в один кластер. **Это и есть аномалии.**

---

## 4. Алгоритм действий (Workflow)

1.  **Визуализация:** Построй гистограммы и Box Plot («ящик с усами»). Глазами видно лучше всего.
2.  **Одномерный поиск:** Пройдись IQR или Z-score по ключевым столбцам.
3.  **Многомерный поиск:** Запусти Isolation Forest на всем датасете.
4.  **Интерпретация (Самое важное!):**
    *   Это ошибка ввода? (Рост -10 см) $\to$ **Удалить/Исправить**.
    *   Это редкое событие? (Миллиардер в данных о доходах) $\to$ **Оставить** (или логарифмировать), иначе модель не научится работать с богатыми.

## 5. Главные ошибки (Заповеди)
1.  **Не удаляй всё подряд.** "Чистый" датасет без выбросов может быть оторван от реальности.
2.  **Не верь одному методу.** Если Z-score говорит "выброс", а Box Plot выглядит норм — проверь глазами.
3.  **DBSCAN капризный.** Он плох, если плотность данных разная в разных частях пространства.