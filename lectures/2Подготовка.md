# üõ† –®–ü–û–†–ê: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞, –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –∏ –í–∞–ª–∏–¥–∞—Ü–∏—è

## 1. –ë–∞–∑–æ–≤–∞—è –≥–∏–≥–∏–µ–Ω–∞ (–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å)
–ü–µ—Ä–≤–æ–µ, —á—Ç–æ –ø–∏—à–µ–º –≤ –Ω–æ—É—Ç–±—É–∫–µ. –ë–µ–∑ —ç—Ç–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞—É—á–Ω—ã–º.
```python
import random
import numpy as np
SEED = 42
random.seed(SEED)
np.random.seed(SEED)
# + random_state=SEED –≤–æ –≤—Å–µ—Ö –º–æ–¥–µ–ª—è—Ö/—Å–ø–ª–∏—Ç–∞—Ö
```

## 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –†–∞–∑–≤–µ–¥–∫–∞ (EDA)
**–ß—Ç–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö CSV:**
```python
df = pd.read_csv('data.csv', 
    encoding='utf-8',       # –∏–ª–∏ 'cp1251'
    sep=',',                # —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
    parse_dates=['date'],   # —Å—Ä–∞–∑—É –≤ datetime
    dayfirst=True,          # –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ 31.12.2023
    na_values=['?', 'nA']   # —á—Ç–æ —Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–æ–º
)
```
**–ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1.  `df.shape`, `df.dtypes` ‚Äî —Ä–∞–∑–º–µ—Ä—ã –∏ —Ç–∏–ø—ã.
2.  `df.duplicated().sum()` ‚Äî –µ—Å—Ç—å –ª–∏ –ø–æ–ª–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã?
3.  `df.isnull().sum()` ‚Äî –≥–¥–µ –ø—Ä–æ–ø—É—Å–∫–∏?

---

## 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ (Missing Values)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–±–æ—Ä–∞:**
*   **< 5%** –ø—Ä–æ–ø—É—Å–∫–æ–≤ $\to$ –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ (`dropna`).
*   **5-30%** –ø—Ä–æ–ø—É—Å–∫–æ–≤ $\to$ –ò–º–ø—É—Ç–∞—Ü–∏—è (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ).
*   **> 30%** –ø—Ä–æ–ø—É—Å–∫–æ–≤ $\to$ –£–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü (—Å–ª–∏—à–∫–æ–º –º–∞–ª–æ –∏–Ω—Ñ—ã).

**–ö–æ–¥ (sklearn):**
```python
from sklearn.impute import SimpleImputer, KNNImputer

# 1. –ü—Ä–æ—Å—Ç–∞—è (Mean/Median –¥–ª—è —á–∏—Å–µ–ª, Mode –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
imputer = SimpleImputer(strategy='median') 

# 2. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è (KNN - –±–µ—Ä–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –ø–æ—Ö–æ–∂–∏–º —Å–æ—Å–µ–¥—è–º)
knn_imputer = KNNImputer(n_neighbors=5)

# –í–ê–ñ–ù–û: fit —Ç–æ–ª—å–∫–æ –Ω–∞ TRAIN, transform –Ω–∞ TRAIN –∏ TEST
X_train = imputer.fit_transform(X_train)
X_test = imputer.transform(X_test)
```

---

## 4. –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (Encoding)

**–ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –≤—ã–±—Ä–∞—Ç—å?**

| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –ú–æ–¥–µ–ª—å | –ú–µ—Ç–æ–¥ | –ö–æ–¥ |
| :--- | :--- | :--- | :--- |
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–µ** (S, M, L) | –õ—é–±–∞—è | **Ordinal / Mapping** | `.map({'S':1, 'M':2})` |
| **–ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ** (–ì–æ—Ä–æ–¥–∞) | –õ–∏–Ω–µ–π–Ω—ã–µ / KNN / NN | **One-Hot Encoding** | `OneHotEncoder(drop='first')` |
| **–ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ** | –î–µ—Ä–µ–≤—å—è (RF, XGB) | **Label Encoding** | `LabelEncoder` |
| **–ú–Ω–æ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** (>50) | –õ—é–±–∞—è | **Target / Binary** | `category_encoders` |

**‚ö†Ô∏è –û–ø–∞—Å–Ω–æ—Å—Ç—å:**
*   **Dummy Trap:** –í One-Hot –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π `drop='first'` (—É–¥–∞–ª—è–π –æ–¥–Ω—É –∫–æ–ª–æ–Ω–∫—É), –∏–Ω–∞—á–µ –±—É–¥–µ—Ç –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å.
*   **Target Encoding:** –í–µ–ª–∏–∫ —Ä–∏—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ (smoothing) –∏–ª–∏ CV.

---

## 5. –í—ã–±—Ä–æ—Å—ã (Outliers) –∏ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (Scaling)

### –ü–æ–∏—Å–∫ –≤—ã–±—Ä–æ—Å–æ–≤
1.  **IQR (–ú–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–∞—Ö):** –ì—Ä–∞–Ω–∏—Ü—ã $[Q1 - 1.5 \times IQR, \,\, Q3 + 1.5 \times IQR]$. –í—Å—ë, —á—Ç–æ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ ‚Äî –≤—ã–±—Ä–æ—Å.
2.  **Z-score:** –ó–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–∏–ª–æ—Å—å –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 3 —Å–∏–≥–º—ã ($|z| > 3$).

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (Feature Scaling)
–ù—É–∂–Ω–æ –¥–ª—è: –õ–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, KNN, SVM, –ù–µ–π—Ä–æ—Å–µ—Ç–µ–π, PCA.
*–ù–µ –Ω—É–∂–Ω–æ –¥–ª—è: –î–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π.*

| Scaler | –§–æ—Ä–º—É–ª–∞ | –ö–æ–≥–¥–∞ –±—Ä–∞—Ç—å |
| :--- | :--- | :--- |
| **StandardScaler** | $\frac{x-\mu}{\sigma}$ | **–î–µ—Ñ–æ–ª—Ç–Ω—ã–π –≤—ã–±–æ—Ä**. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ. |
| **MinMaxScaler** | $\frac{x-min}{max-min}$ | –ù—É–∂–µ–Ω –¥–∏–∞–ø–∞–∑–æ–Ω [0, 1] (–¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫, –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π). |
| **RobustScaler** | –ú–µ–¥–∏–∞–Ω–∞ –∏ IQR | –ï—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö **–º–Ω–æ–≥–æ –≤—ã–±—Ä–æ—Å–æ–≤**. |

**üî• –ó–û–õ–û–¢–û–ï –ü–†–ê–í–ò–õ–û:**
`scaler.fit()` –¥–µ–ª–∞–µ–º **–¢–û–õ–¨–ö–û –Ω–∞ Train**. –ù–∞ Test –¥–µ–ª–∞–µ–º —Ç–æ–ª—å–∫–æ `transform()`.
*–ò–Ω–∞—á–µ ‚Äî —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö (Data Leakage).*

---

## 6. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –£—Ç–µ—á–∫–∏ (Leakage) ‚Äî –≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–æ–ø!

### –ö–∞–∫ –¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ?
```python
from sklearn.model_selection import train_test_split

# 1. –ö–ª–∞—Å—Å–∏–∫–∞
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)

# 2. –ï—Å—Ç—å –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ (90% vs 10%)
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ stratify=y, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏
X_train, X_test, ... = train_test_split(..., stratify=y)

# 3. –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã (Time Series)
# –ù–ï–õ–¨–ó–Ø random shuffle! –ë—É–¥—É—â–µ–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å –≤ –ø—Ä–æ—à–ª–æ–µ.
from sklearn.model_selection import TimeSeriesSplit
```

### –í–∏–¥—ã —É—Ç–µ—á–µ–∫ (Data Leakage)
–ï—Å–ª–∏ –º–µ—Ç—Ä–∏–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Å–æ–∫–∞—è ‚Äî –∏—â–∏ —É—Ç–µ—á–∫—É.
1.  **–°–∫–µ–π–ª–∏–Ω–≥ –¥–æ —Å–ø–ª–∏—Ç–∞:** –ü–æ—Å—á–∏—Ç–∞–ª–∏ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É $\to$ —Ç–µ—Å—Ç "–ø–æ–¥—Å–º–æ—Ç—Ä–µ–ª" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–µ–π–Ω–∞.
2.  **–ë—É–¥—É—â–µ–µ –≤ –ø—Ä–æ—à–ª–æ–º:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è *–ø–æ—Å–ª–µ* —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞ –∫–ª–∏–µ–Ω—Ç—É" –ø—Ä–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏ "–æ—Ç–≤–µ—Ç–∏—Ç –ª–∏ –∫–ª–∏–µ–Ω—Ç").

---

## 7. –î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤
*–ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–π –∫–ª–∞—Å—Å –∏ –ø–æ–ª—É—á–∞–µ—Ç Accuracy 99%.*

**–†–µ—à–µ–Ω–∏–µ:**
1.  **–ú–µ—Ç—Ä–∏–∫–∏:** –ó–∞–±—ã—Ç—å –ø—Ä–æ Accuracy. –°–º–æ—Ç—Ä–µ—Ç—å **F1-score, ROC-AUC, Precision/Recall**.
2.  **–°—ç–º–ø–ª–∏–Ω–≥:**
    *   `SMOTE` (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –º–µ–Ω—å—à–∏–Ω—Å—Ç–≤–∞) ‚Äî –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞–ª–æ.
    *   `RandomUnderSampler` (–≤—ã–∫–∏–¥—ã–≤–∞–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ) ‚Äî –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –æ—á–µ–Ω—å –º–Ω–æ–≥–æ.
3.  **–í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ:** –ü–∞—Ä–∞–º–µ—Ç—Ä `class_weight='balanced'` –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–µ–ª–µ–π.

---

## 8. –§–æ—Ä–º—É–ª—ã –¥–ª—è –∑–∞–∑—É–±—Ä–∏–≤–∞–Ω–∏—è

1.  **Bias-Variance Tradeoff:**
    *   **High Bias (–ù–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ):** –ú–æ–¥–µ–ª—å —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è (–ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è –Ω–∞ –ø–∞—Ä–∞–±–æ–ª–µ).
    *   **High Variance (–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ):** –ú–æ–¥–µ–ª—å —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–∞—è, –≤—ã—É—á–∏–ª–∞ —à—É–º.
2.  **–ú–µ—Ç—Ä–∏–∫–∏:**
    *   **Precision (–¢–æ—á–Ω–æ—Å—Ç—å):** $\frac{TP}{TP + FP}$ (–ù–µ –≤—Ä–∞—Ç—å. –í–∞–∂–Ω–æ, –∫–æ–≥–¥–∞ —Ü–µ–Ω–∞ –ª–æ–∂–Ω–æ–π —Ç—Ä–µ–≤–æ–≥–∏ –≤—ã—Å–æ–∫–∞, –Ω-—Ä —Å–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä).
    *   **Recall (–ü–æ–ª–Ω–æ—Ç–∞):** $\frac{TP}{TP + FN}$ (–ù–∞–π—Ç–∏ –≤—Å–µ—Ö. –í–∞–∂–Ω–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –±–æ–ª–µ–∑–Ω–µ–π).
    *   **F1:** –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ Precision –∏ Recall.